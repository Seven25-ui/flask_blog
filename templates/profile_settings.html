<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile Settings ‚Ä¢ Seven33</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' };</script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 min-h-screen p-4 md:p-8">
    
    <div class="max-w-lg mx-auto flex justify-end mb-4">
        <button id="darkToggle" class="p-2 bg-white dark:bg-gray-800 shadow-sm border dark:border-gray-700 rounded-full transition">üí°</button>
    </div>

    <div class="max-w-lg mx-auto bg-white dark:bg-gray-800 p-8 rounded-3xl shadow-xl border border-gray-100 dark:border-gray-700">
        <h2 class="text-3xl font-black text-gray-800 dark:text-white mb-6 text-center tracking-tighter">‚öôÔ∏è SETTINGS</h2>

        <div class="flex flex-col items-center mb-8 pb-6 border-b border-gray-100 dark:border-gray-700">
            <div class="relative">
                <img id="preview_img" src="{{ user.profile_pic }}"
                     alt="Profile Picture"
                     class="w-32 h-32 rounded-full object-cover border-4 border-blue-500 shadow-md">
                <span class="absolute bottom-1 right-1 bg-green-500 w-5 h-5 rounded-full border-2 border-white dark:border-gray-800"></span>
            </div>
            <p class="mt-3 text-sm font-bold text-gray-600 dark:text-gray-300">@{{ user.username }}</p>
            <p class="text-[10px] text-gray-400 uppercase font-bold tracking-[0.2em] mt-1">Live Preview</p>
        </div>

        <form method="POST" enctype="multipart/form-data" class="space-y-6">
            <div>
                <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2 uppercase tracking-wide">Profile Picture</label>
                <input type="file" name="profile_pic" id="profile_input" accept="image/*"
                       class="w-full p-2 text-xs border border-gray-200 dark:border-gray-600 dark:bg-gray-700 rounded-xl focus:ring-2 focus:ring-blue-500 outline-none transition file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:bg-blue-50 dark:file:bg-blue-900/30 file:text-blue-700 dark:file:text-blue-400 hover:file:bg-blue-100 cursor-pointer">
                <p class="text-[10px] text-gray-400 mt-2 italic">Supported: JPG, PNG, WEBP. Uploaded via Cloudinary.</p>
            </div>

            <div>
                <label class="block text-sm font-bold text-gray-700 dark:text-gray-300 mb-2 uppercase tracking-wide">Bio / About Me</label>
                <textarea name="bio" rows="4" placeholder="Share a little story about yourself..."
                          class="w-full p-4 border border-gray-200 dark:border-gray-600 dark:bg-gray-700 rounded-2xl focus:ring-2 focus:ring-blue-500 outline-none transition text-gray-700 dark:text-gray-200">{{ user.bio or '' }}</textarea>
                <p class="text-[10px] text-gray-400 mt-1">This will be displayed on your public profile and posts.</p>
            </div>

            <button type="submit"
                    class="w-full bg-blue-600 hover:bg-blue-700 text-white font-black py-4 rounded-2xl shadow-lg shadow-blue-500/30 transform active:scale-95 transition-all uppercase tracking-widest text-sm">
                Save Changes
            </button>
        </form>

        <div class="mt-8 pt-6 border-t border-gray-100 dark:border-gray-700">
            <h3 class="text-xs font-black text-gray-400 uppercase tracking-widest mb-4">Security</h3>
            <a href="{{ url_for('change_password') }}" 
               class="flex items-center justify-between w-full p-4 bg-gray-50 dark:bg-gray-700/50 hover:bg-gray-100 dark:hover:bg-gray-700 rounded-2xl transition group border border-transparent hover:border-blue-500/30">
                <div class="flex items-center gap-3">
                    <span class="text-xl">üîê</span>
                    <div class="text-left">
                        <p class="text-sm font-bold">Change Password</p>
                        <p class="text-[10px] text-gray-500">Update your account security</p>
                    </div>
                </div>
                <span class="text-gray-400 group-hover:text-blue-500 transition">‚Üí</span>
            </a>
        </div>

        <div class="mt-8 text-center border-t dark:border-gray-700 pt-6">
            <a href="{{ url_for('dashboard') }}" class="text-blue-500 hover:text-blue-600 font-bold text-sm transition">
                ‚Üê Return to Dashboard
            </a>
        </div>
    </div>

    <script>
        // Preview image before uploading
        const profileInput = document.getElementById('profile_input');
        const previewImg = document.getElementById('preview_img');

        profileInput.onchange = evt => {
            const [file] = profileInput.files;
            if (file) {
                previewImg.src = URL.createObjectURL(file);
            }
        }

        // Dark Mode Logic
        const darkToggle = document.getElementById('darkToggle');
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
            darkToggle.innerText = '‚òÄÔ∏è';
        }

        darkToggle.addEventListener('click', () => {
            document.documentElement.classList.toggle('dark');
            const isDark = document.documentElement.classList.contains('dark');
            localStorage.setItem('darkMode', isDark);
            darkToggle.innerText = isDark ? '‚òÄÔ∏è' : 'üí°';
        });
    </script>
</body>
</html>
