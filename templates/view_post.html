<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ post.title }} ‚Ä¢ Seven33</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>tailwind.config = { darkMode: 'class' };</script>
</head>
<body class="bg-gray-50 dark:bg-gray-900 text-gray-900 dark:text-gray-100 transition-colors duration-300 min-h-screen">

<header class="bg-white dark:bg-gray-800 shadow-sm sticky top-0 z-50 border-b dark:border-gray-700">
    <div class="max-w-3xl mx-auto p-4 flex justify-between items-center">
        <a href="{{ url_for('public_home') }}" class="text-blue-600 font-bold flex items-center gap-2 hover:underline">
            <span class="text-xl">‚Üê</span> Back
        </a>
        
        <div class="flex items-center gap-4">
            <button id="darkToggle" class="p-2 bg-gray-100 dark:bg-gray-700 rounded-full transition">üí°</button>
            <h1 class="text-lg font-black tracking-tighter text-gray-400">SEVEN33</h1>
        </div>
    </div>
</header>

<main class="max-w-3xl mx-auto p-4 sm:p-8 mt-4">
    <article class="bg-white dark:bg-gray-800 rounded-3xl shadow-sm border border-gray-100 dark:border-gray-700 overflow-hidden">
        
        <div class="p-6 sm:p-10 pb-4">
            <h1 class="text-3xl sm:text-4xl font-extrabold leading-tight mb-4">{{ post.title }}</h1>
            
            <div class="flex items-center gap-3 py-4 border-y border-gray-50 dark:border-gray-700/50">
                {% set author = get_user_by_username(post.author) %}
                <img src="{{ url_for('uploaded_file', filename=author.profile_pic if author else 'default-avatar.png') }}"
                     onerror="this.src='https://ui-avatars.com/api/?name={{ post.author }}&background=0D8ABC&color=fff'"
                     class="w-12 h-12 rounded-full object-cover ring-2 ring-gray-100 dark:ring-gray-700 shadow-sm">
                <div>
                    <p class="font-bold text-blue-600">{{ post.author }}</p>
                    <p class="text-xs text-gray-500">{{ post.created_at.strftime('%B %d, %Y') }} ‚Ä¢ {{ get_read_time(post.content) }} min read</p>
                </div>
            </div>
        </div>

        {% if post.media_file %}
        <div class="w-full bg-gray-100 dark:bg-gray-900 border-b dark:border-gray-700">
            {% if post.media_type == 'image' %}
                <img src="{{ url_for('uploaded_file', filename=post.media_file) }}" class="w-full h-auto max-h-[700px] object-contain mx-auto">
            {% elif post.media_type == 'video' %}
                <video controls class="w-full shadow-inner">
                    <source src="{{ url_for('uploaded_file', filename=post.media_file) }}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            {% endif %}
        </div>
        {% endif %}

        <div class="p-6 sm:p-10 pt-8 text-lg leading-relaxed text-gray-700 dark:text-gray-300">
            <div class="whitespace-pre-wrap">{{ post.content | safe }}</div>
            
            {% if post.tags %}
            <div class="mt-10 flex flex-wrap gap-2">
                {% for tag in post.tags.split(',') %}
                    <span class="bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400 px-3 py-1 rounded-full text-sm font-semibold">
                        #{{ tag.strip() }}
                    </span>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </article>
</main>

<footer class="text-center py-10 text-gray-400 text-sm">
    &copy; 2026 Seven33 Blog. All rights reserved.
</footer>

<script>
    const darkToggle = document.getElementById('darkToggle');
    
    // Check if darkMode was already active
    if (localStorage.getItem('darkMode') === 'true') {
        document.documentElement.classList.add('dark');
    }

    darkToggle.addEventListener('click', () => {
        document.documentElement.classList.toggle('dark');
        // Save the setting to localStorage
        localStorage.setItem('darkMode', document.documentElement.classList.contains('dark'));
    });
</script>

</body>
</html>
